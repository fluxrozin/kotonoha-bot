# プロダクトバックログ

## 1. バックログ一覧

### Phase 1: 基盤実装

| ID     | 項目                                         | 優先度 | 見積もり | ステータス |
| ------ | -------------------------------------------- | ------ | -------- | ---------- |
| PB-001 | Discord ボットの基本セットアップ             | 高     | 3        | 未着手     |
| PB-002 | チャット AI サービスの抽象化インターフェース | 高     | 5        | 未着手     |
| PB-003 | Gemini API 実装                              | 高     | 8        | 未着手     |
| PB-004 | メンション応答型の実装                       | 高     | 5        | 未着手     |
| PB-005 | SQLite データベースセットアップ              | 高     | 3        | 未着手     |
| PB-006 | ChatSession 管理モジュール                   | 高     | 8        | 未着手     |
| PB-007 | Dockerfile 作成                              | 中     | 3        | 未着手     |
| PB-008 | 基本的なエラーハンドリング                   | 高     | 5        | 未着手     |

### Phase 2: 機能拡張

| ID     | 項目                           | 優先度 | 見積もり | ステータス |
| ------ | ------------------------------ | ------ | -------- | ---------- |
| PB-009 | セッション同期機能             | 高     | 8        | 未着手     |
| PB-010 | スレッド型の実装               | 高     | 10       | 未着手     |
| PB-011 | DM 型の実装                    | 中     | 5        | 未着手     |
| PB-012 | 聞き耳型（アプローチ 1）の実装 | 高     | 13       | 未着手     |
| PB-013 | 聞き耳型（アプローチ 2）の実装 | 中     | 5        | 未着手     |
| PB-014 | レート制限対応                 | 高     | 8        | 未着手     |
| PB-015 | コマンド機能の実装             | 中     | 5        | 未着手     |
| PB-016 | CI/CD パイプライン構築         | 中     | 8        | 未着手     |

### Phase 3: 最適化・運用

| ID     | 項目                 | 優先度 | 見積もり | ステータス |
| ------ | -------------------- | ------ | -------- | ---------- |
| PB-017 | ログ機能の実装       | 中     | 5        | 未着手     |
| PB-018 | モニタリング機能     | 中     | 8        | 未着手     |
| PB-019 | バックアップ機能     | 中     | 5        | 未着手     |
| PB-020 | ヘルスチェック機能   | 中     | 3        | 未着手     |
| PB-021 | パフォーマンス最適化 | 低     | 8        | 未着手     |

**見積もり単位**: ストーリーポイント（1 ポイント = 約 0.5 日）

---

## 2. 詳細バックログ項目

### PB-001: Discord ボットの基本セットアップ

**説明**: discord.py を使用して Discord ボットの基本機能を実装する。

**受け入れ基準**:

- Bot が Discord に接続できる
- `on_ready` イベントが発火する
- `on_message` イベントが発火する
- 基本的なメッセージの送受信ができる

**依存関係**: なし

---

### PB-003: Gemini API 実装

**説明**: Gemini API を使用して AI 応答を生成する機能を実装する。

**受け入れ基準**:

- Gemini 1.5 Flash で応答を生成できる
- Gemini 1.5 Pro で応答を生成できる
- プロンプトを動的に生成できる
- エラーハンドリングが実装されている

**依存関係**: PB-002

---

### PB-010: スレッド型の実装

**説明**: メンション時に自動でスレッドを作成し、その中で会話を継続する機能を実装する。

**受け入れ基準**:

- メンション時にスレッドが自動作成される
- スレッド内でメンションなしで会話を継続できる
- スレッドアーカイブ時にセッションが保存される

**依存関係**: PB-001, PB-006

---

### PB-012: 聞き耳型（アプローチ 1）の実装

**説明**: LLM に「空気」を読ませて、適切なタイミングで会話に参加する機能を実装する。

**受け入れ基準**:

- 会話ログを一時保存できる
- Gemini Flash で判定（Yes/No）できる
- YES の場合のみ応答を生成して送信できる
- 判定用プロンプトが最適化されている

**依存関係**: PB-003, PB-006

---

## 3. スプリント計画

### Sprint 1 (Week 1-2)

**目標**: Phase 1 の基盤実装

**バックログ項目**:

- PB-001: Discord ボットの基本セットアップ
- PB-002: チャット AI サービスの抽象化インターフェース
- PB-005: SQLite データベースセットアップ

**見積もり合計**: 11 ポイント

---

### Sprint 2 (Week 3-4)

**目標**: AI 機能とメンション応答型の実装

**バックログ項目**:

- PB-003: Gemini API 実装
- PB-004: メンション応答型の実装
- PB-006: ChatSession 管理モジュール

**見積もり合計**: 21 ポイント

---

### Sprint 3 (Week 5-6)

**目標**: セッション管理とスレッド型の実装

**バックログ項目**:

- PB-009: セッション同期機能
- PB-010: スレッド型の実装
- PB-008: 基本的なエラーハンドリング

**見積もり合計**: 23 ポイント

---

### Sprint 4 (Week 7-8)

**目標**: 聞き耳型とその他機能の実装

**バックログ項目**:

- PB-012: 聞き耳型（アプローチ 1）の実装
- PB-011: DM 型の実装
- PB-014: レート制限対応

**見積もり合計**: 26 ポイント

---

### Sprint 5 (Week 9-10)

**目標**: CI/CD と運用機能の実装

**バックログ項目**:

- PB-016: CI/CD パイプライン構築
- PB-015: コマンド機能の実装
- PB-007: Dockerfile 作成

**見積もり合計**: 16 ポイント

---

### Sprint 6 (Week 11-12)

**目標**: 最適化と運用機能

**バックログ項目**:

- PB-017: ログ機能の実装
- PB-018: モニタリング機能
- PB-019: バックアップ機能
- PB-020: ヘルスチェック機能

**見積もり合計**: 21 ポイント

---

## 4. リスク管理

| リスク             | 影響度 | 発生確率 | 対策                         |
| ------------------ | ------ | -------- | ---------------------------- |
| API の無料枠終了   | 高     | 中       | 複数 API に対応              |
| レート制限超過     | 中     | 高       | レート制限監視と対応         |
| パフォーマンス問題 | 中     | 中       | パフォーマンステストと最適化 |
| データ損失         | 高     | 低       | バックアップ機能の実装       |

---

**作成日**: 2024 年
**バージョン**: 1.0
**作成者**: kotonoha-bot 開発チーム

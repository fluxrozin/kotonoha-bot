# テスト計画書

## 1. テスト概要

### 1.1 テストの目的

Kotonoha（コトノハ）Discord ボットの品質を保証し、場面緘黙支援に適した動作を確認する。

### 1.2 テスト範囲

- 機能テスト（4 つの会話の契機）
- セッション管理テスト
- AI 応答生成テスト
- エラーハンドリングテスト
- パフォーマンステスト
- セキュリティテスト

### 1.3 テスト環境

| 環境           | 説明                               |
| -------------- | ---------------------------------- |
| **開発環境**   | WSL2 Ubuntu、ローカルテスト        |
| **テスト環境** | Discord テストサーバー、モック API |
| **本番環境**   | Synology NAS、実際の API           |

---

## 2. テスト戦略

### 2.1 テストレベル

| レベル             | 説明                     | 実施時期       |
| ------------------ | ------------------------ | -------------- |
| **単体テスト**     | 各モジュールのテスト     | 開発中         |
| **統合テスト**     | モジュール間の連携テスト | Phase 2 完了後 |
| **システムテスト** | システム全体のテスト     | Phase 3 完了後 |
| **受入テスト**     | ユーザーによるテスト     | リリース前     |

### 2.2 テスト手法

- **ホワイトボックステスト**: コードの内部構造を理解した上でのテスト
- **ブラックボックステスト**: 機能仕様に基づいたテスト
- **回帰テスト**: 既存機能への影響を確認

---

## 3. テスト項目

### 3.1 機能テスト

| ID     | テスト項目             | 優先度 | 実装フェーズ |
| ------ | ---------------------- | ------ | ------------ |
| FT-001 | メンション応答型の動作 | 高     | Phase 1      |
| FT-002 | スレッド型の動作       | 高     | Phase 2      |
| FT-003 | DM 型の動作            | 中     | Phase 2      |
| FT-004 | 聞き耳型の動作         | 高     | Phase 2      |
| FT-005 | 会話履歴の保持         | 高     | Phase 1      |
| FT-006 | 会話履歴のリセット     | 中     | Phase 2      |
| FT-007 | セッションの復元       | 中     | Phase 2      |

### 3.2 エラーハンドリングテスト

| ID     | テスト項目                 | 優先度 |
| ------ | -------------------------- | ------ |
| ET-001 | API エラー時の処理         | 高     |
| ET-002 | レート制限時の処理         | 高     |
| ET-003 | タイムアウト時の処理       | 中     |
| ET-004 | データベースエラー時の処理 | 中     |

### 3.3 パフォーマンステスト

| ID     | テスト項目           | 目標値         |
| ------ | -------------------- | -------------- |
| PT-001 | 応答時間             | 3 秒以内       |
| PT-002 | セッション取得時間   | 100ms 以内     |
| PT-003 | データベース操作時間 | 50ms 以内      |
| PT-004 | 同時セッション数     | 100 セッション |

---

## 4. テスト環境構築

### 4.1 テスト用 Discord サーバー

- 専用のテストサーバーを作成
- テスト用 Bot を追加
- テスト用チャンネルを作成

### 4.2 モック API

- Gemini API をモック化
- レート制限をシミュレート
- エラーレスポンスをシミュレート

### 4.3 テストデータ

- テスト用セッションデータ
- テスト用メッセージデータ
- テスト用設定データ

---

## 5. テストスケジュール

| フェーズ           | 期間           | テスト内容           |
| ------------------ | -------------- | -------------------- |
| **Phase 1 テスト** | Phase 1 完了後 | 基本機能のテスト     |
| **Phase 2 テスト** | Phase 2 完了後 | 全機能のテスト       |
| **Phase 3 テスト** | Phase 3 完了後 | システム全体のテスト |
| **受入テスト**     | リリース前     | ユーザーによるテスト |

---

## 6. テスト結果管理

### 6.1 テスト結果の記録

- テスト結果を記録
- バグレポートを作成
- テストカバレッジを測定

### 6.2 バグ管理

- バグの優先度を設定
- バグの修正状況を追跡
- バグの再テストを実施

---

**作成日**: 2024 年
**バージョン**: 1.0
**作成者**: kotonoha-bot 開発チーム
